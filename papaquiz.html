<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Page</title>
    <meta name="google" content="notranslate">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="invite-list">
    <p>Invite List:</p>
    <div class="invite-item">
        <img src="papa.jpg" alt="Axel">
        <p>Axel</p>
    </div>
    <div class="invite-item">
        <img src="mama.jpg" alt="Monique">
        <p>Monique</p>
    </div>
</div>
<div class="score" id="scoreDisplay"></div>
<div id="questionContainer" class="container"></div>
<div class="popup" id="popupMessage" onclick="hidePopup()">
    <p>Wytze eet ook mee!</p>
</div>
<script>
    let currentQuestionIndex = 0;
    let questions = [];

    async function loadQuestions() {
        const response = await fetch('questions.json');
        questions = await response.json();
        loadQuestion(currentQuestionIndex);
    }

    function loadQuestion(index) {
        const questionContainer = document.getElementById("questionContainer");
        const questionData = questions[index];
        const newQuestionHTML = `
            <div>
                <textarea class="textbox" rows="4" readonly>${questionData.explanation}</textarea>
            </div>
            <div>
                <p>${questionData.question}</p>
            </div>
            <div>
                <input type="text" class="answer-box" id="answer1" placeholder="${questionData.placeholders[0]}">
            </div>
            <div>
                <input type="text" class="answer-box" id="answer2" placeholder="${questionData.placeholders[1]}">
            </div>
            <div>
                <input type="text" class="answer-box" id="answer3" placeholder="${questionData.placeholders[2]}">
            </div>
            <div>
                <input type="text" class="answer-box" id="answer4" placeholder="${questionData.placeholders[3]}">
            </div>
            <div>
                <button class="button" onclick="bevestig()">Bevestig</button>
            </div>
            <div id="resultMessage"></div>
        `;
        questionContainer.innerHTML = newQuestionHTML;
    }

    function bevestig() {
        const currentQuestion = questions[currentQuestionIndex];
        const correctAnswers = currentQuestion.correctAnswers;
        let userAnswers = [
            document.getElementById("answer1").value.trim().toLowerCase(),
            document.getElementById("answer2").value.trim().toLowerCase(),
            document.getElementById("answer3").value.trim().toLowerCase(),
            document.getElementById("answer4").value.trim().toLowerCase()
        ];
        let correctCount = 0;

        for (let i = 0; i < userAnswers.length; i++) {
            if (userAnswers[i] === correctAnswers[i].toLowerCase()) {
                correctCount++;
            }
        }

        const scoreDisplay = document.getElementById("scoreDisplay");
        const resultMessage = document.getElementById("resultMessage");
        scoreDisplay.innerHTML = `Your Score: ${correctCount}/4`;
        resultMessage.innerHTML = `You got ${correctCount} out of 4 correct!`;

        if (correctCount >= 4) {
            showPopup();
            const inviteList = document.querySelector(".invite-list");
            const thirdInviteItem = `
                <div class="invite-item">
                    <img src="wytze.jpg" alt="Wytze">
                    <p>Wytze</p>
                </div>
            `;
            inviteList.insertAdjacentHTML('beforeend', thirdInviteItem);
        }

        currentQuestionIndex++;
        if (currentQuestionIndex < questions.length) {
            loadQuestion(currentQuestionIndex);
        } else {
            resultMessage.innerHTML += `<br><br>The quiz is over! Thanks for participating.`;
        }
    }

    window.onload = loadQuestions;
</script>
</body>
</html>
